<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thronos AI Architect</title>
  <style>
    :root {
      --bg: #050a07;
      --panel: #071810;
      --accent: #00ff66;
      --accent-soft: rgba(0, 255, 102, 0.1);
      --text: #c8ffd8;
      --muted: #7aa398;
      --border: #1a3b2e;
      --danger: #ff4b81;
      --purple: #b366ff;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #050a07 0%, #0a1810 100%);
      color: var(--text);
      min-height: 100vh;
    }

    /* Language toggle */
    .lang-en, .lang-ja, .lang-ru, .lang-es { display: none; }
    body.lang-en .lang-el { display: none; }
    body.lang-en .lang-en { display: inline; }
    body.lang-ja .lang-el { display: none; }
    body.lang-ja .lang-ja { display: inline; }
    body.lang-ru .lang-el { display: none; }
    body.lang-ru .lang-ru { display: inline; }
    body.lang-es .lang-el { display: none; }
    body.lang-es .lang-es { display: inline; }

    .top {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 20px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(135deg, rgba(7, 24, 16, 0.95), rgba(5, 10, 7, 0.98));
      backdrop-filter: blur(10px);
      flex-wrap: wrap;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-icon {
      width: 36px;
      height: 36px;
      border: 2px solid var(--accent);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: var(--accent);
      box-shadow: 0 0 15px rgba(0, 255, 102, 0.3);
    }

    .logo-text {
      font-size: 16px;
      font-weight: 600;
      letter-spacing: 0.1em;
    }

    .pill {
      border: 1px solid var(--accent);
      border-radius: 999px;
      padding: 6px 14px;
      color: var(--accent);
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .pill-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 8px var(--accent);
    }

    .lang-toggle {
      margin-left: auto;
      background: var(--accent-soft);
      border: 1px solid var(--border);
      color: var(--accent);
      padding: 6px 14px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 12px;
    }

    .lang-toggle:hover {
      background: rgba(0, 255, 102, 0.2);
    }

    select, textarea, input, button {
      background: rgba(7, 20, 13, 0.9);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px 14px;
      font-size: 14px;
      transition: all 0.3s;
    }

    select:focus, textarea:focus, input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 15px rgba(0, 255, 102, 0.2);
    }

    button {
      cursor: pointer;
      font-weight: 600;
    }

    button:hover {
      background: var(--accent-soft);
      border-color: var(--accent);
    }

    .wrap {
      display: grid;
      grid-template-columns: 350px 1fr;
      min-height: calc(100vh - 70px);
    }

    @media (max-width: 900px) {
      .wrap {
        grid-template-columns: 1fr;
      }
    }

    .left {
      border-right: 1px solid var(--border);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      background: rgba(7, 24, 16, 0.3);
    }

    .right {
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .section-title {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--muted);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    textarea {
      min-height: 200px;
      resize: vertical;
      font-family: inherit;
      line-height: 1.5;
    }

    .generate-btn {
      background: linear-gradient(135deg, var(--accent) 0%, #00cc55 100%);
      color: #000;
      border: none;
      padding: 16px 24px;
      font-size: 15px;
      letter-spacing: 0.1em;
      box-shadow: 0 0 20px rgba(0, 255, 102, 0.3);
    }

    .generate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 30px rgba(0, 255, 102, 0.5);
    }

    .generate-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    pre {
      background: linear-gradient(135deg, rgba(7, 17, 10, 0.95), rgba(5, 10, 7, 0.98));
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 20px;
      white-space: pre-wrap;
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      line-height: 1.6;
      flex: 1;
      overflow-y: auto;
      min-height: 400px;
      max-height: calc(100vh - 250px);
    }

    .files-output {
      background: rgba(179, 102, 255, 0.1);
      border: 1px solid var(--purple);
      border-radius: 10px;
      padding: 12px;
      font-size: 12px;
      color: var(--purple);
    }

    .tip-box {
      background: var(--accent-soft);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      font-size: 12px;
      color: var(--muted);
    }

    .tip-box strong {
      color: var(--accent);
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .input-row {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .input-row input {
      flex: 1;
    }

    .status-indicator {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
    }

    .status-indicator.online { color: var(--accent); }
    .status-indicator.offline { color: var(--danger); }
  </style>
</head>
<body>
  <div class="top">
    <div class="logo">
      <div class="logo-icon">ğŸ—ï¸</div>
      <div class="logo-text">AI ARCHITECT</div>
    </div>
    <div class="pill" id="statusPill">
      <div class="pill-dot"></div>
      <span class="lang-el">Online</span>
      <span class="lang-en">Online</span>
      <span class="lang-ja">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³</span>
      <span class="lang-ru">ĞĞ½Ğ»Ğ°Ğ¹Ğ½</span>
      <span class="lang-es">En lÃ­nea</span>
    </div>
    <div class="input-row">
      <span class="section-title" style="margin: 0;">Wallet</span>
      <input id="wallet" placeholder="THR..." style="width: 200px"/>
    </div>
    <div class="input-row">
      <span class="section-title" style="margin: 0;">Model</span>
      <select id="model">
        <option value="auto">ğŸ”€ Auto (Pythia chooses)</option>
        <option value="gpt-4o">ğŸ¤– GPT-4o</option>
        <option value="claude-sonnet-4">ğŸ§  Claude Sonnet 4</option>
        <option value="gemini-2.5-pro">ğŸ’ Gemini 2.5 Pro</option>
        <option value="gemini-2.5-flash">âš¡ Gemini 2.5 Flash</option>
        <option value="local">ğŸ’¾ Offline/Local</option>
      </select>
    </div>
    <button class="lang-toggle" onclick="toggleLanguage()">ğŸŒ GR</button>
  </div>

  <div class="wrap">
    <div class="left">
      <div class="input-group">
        <div class="section-title">
          ğŸ“‹ <span class="lang-el">Î•Ï€Î¹Î»Î¿Î³Î® Blueprint</span>
          <span class="lang-en">Select Blueprint</span>
          <span class="lang-ja">ãƒ–ãƒ«ãƒ¼ãƒ—ãƒªãƒ³ãƒˆé¸æŠ</span>
          <span class="lang-ru">Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½</span>
          <span class="lang-es">Seleccionar Blueprint</span>
        </div>
        <select id="blueprint"></select>
      </div>

      <div class="input-group">
        <div class="section-title">
          âœï¸ <span class="lang-el">Î ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î­Ï‚ (Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)</span>
          <span class="lang-en">Custom Specifications (Optional)</span>
          <span class="lang-ja">ã‚«ã‚¹ã‚¿ãƒ ä»•æ§˜ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</span>
          <span class="lang-ru">Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ (ĞĞµĞ¾Ğ±ÑĞ·.)</span>
          <span class="lang-es">Especificaciones (Opcional)</span>
        </div>
        <textarea id="spec" placeholder="Ï€.Ï‡. Î˜Î­Î»Ï‰ login, dashboard, billing, admin panel, API endpoints Î³Î¹Î± users..."></textarea>
      </div>

      <button class="generate-btn" id="generate">
        ğŸš€ <span class="lang-el">Î”Î—ÎœÎ™ÎŸÎ¥Î¡Î“Î™Î‘ Î‘Î¡Î§Î™Î¤Î•ÎšÎ¤ÎŸÎÎ™ÎšÎ—Î£</span>
        <span class="lang-en">GENERATE ARCHITECTURE</span>
        <span class="lang-ja">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç”Ÿæˆ</span>
        <span class="lang-ru">Ğ¡ĞĞ—Ğ”ĞĞ¢Ğ¬ ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ£</span>
        <span class="lang-es">GENERAR ARQUITECTURA</span>
      </button>

      <div class="tip-box">
        <strong>ğŸ’¡ Tip:</strong>
        <span class="lang-el">Î¤Î± blueprints Ï†Î¿ÏÏ„ÏÎ½Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ /app/data/ai_blueprints. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î´Î¹ÎºÎ¬ ÏƒÎ±Ï‚ templates!</span>
        <span class="lang-en">Blueprints are loaded from /app/data/ai_blueprints. You can create your own templates!</span>
        <span class="lang-ja">ãƒ–ãƒ«ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã¯/app/data/ai_blueprintsã‹ã‚‰èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚ç‹¬è‡ªã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã§ãã¾ã™ï¼</span>
        <span class="lang-ru">Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½Ñ‹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ÑÑ‚ÑÑ Ğ¸Ğ· /app/data/ai_blueprints. Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¸!</span>
        <span class="lang-es">Los blueprints se cargan desde /app/data/ai_blueprints. Â¡Puedes crear los tuyos!</span>
      </div>
    </div>

    <div class="right">
      <div class="section-title">
        ğŸ“œ <span class="lang-el">Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± Architect</span>
        <span class="lang-en">Architect Output Log</span>
        <span class="lang-ja">Architectã®å‡ºåŠ›ãƒ­ã‚°</span>
        <span class="lang-ru">Ğ–ÑƒÑ€Ğ½Ğ°Ğ» Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° Architect</span>
        <span class="lang-es">Registro de Salida</span>
      </div>
      <pre id="out">// <span class="lang-el">Î¤Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÎµÎ´Ï...</span><span class="lang-en">Generation output will appear here...</span><span class="lang-ja">ç”ŸæˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</span><span class="lang-ru">Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ÑĞ²Ğ¸Ñ‚ÑÑ Ğ·Ğ´ĞµÑÑŒ...</span><span class="lang-es">El resultado aparecerÃ¡ aquÃ­...</span></pre>
      <div class="files-output" id="files" style="display: none;"></div>
    </div>
  </div>

<script>
const $ = (id) => document.getElementById(id);

// Language support
const LANG_SEQUENCE = ['gr', 'en', 'ja', 'es', 'ru'];
const LANG_CLASS_MAP = { 'gr': 'lang-el', 'en': 'lang-en', 'ja': 'lang-ja', 'es': 'lang-es', 'ru': 'lang-ru' };

function toggleLanguage() {
  const current = localStorage.getItem("lang") || "gr";
  const idx = LANG_SEQUENCE.indexOf(current);
  const next = LANG_SEQUENCE[(idx + 1) % LANG_SEQUENCE.length];
  localStorage.setItem("lang", next);
  applyLanguage();
}

function applyLanguage() {
  const lang = localStorage.getItem("lang") || "gr";
  document.body.className = LANG_CLASS_MAP[lang] || '';
  document.querySelector('.lang-toggle').textContent = 'ğŸŒ ' + lang.toUpperCase();
}

async function api(url, opts) {
  const r = await fetch(url, opts);
  const t = await r.text();
  let j = null;
  try { j = JSON.parse(t); } catch(e) {}
  if (!r.ok) {
    throw new Error((j && (j.error || j.message)) || t || ("HTTP " + r.status));
  }
  return j;
}

function setStatus(ok, text) {
  const pill = $("statusPill");
  const dot = pill.querySelector('.pill-dot');
  dot.style.background = ok ? "var(--accent)" : "var(--danger)";
  dot.style.boxShadow = ok ? "0 0 8px var(--accent)" : "0 0 8px var(--danger)";
}

async function loadBlueprints() {
  const j = await api("/api/ai_blueprints");
  const list = j.blueprints || [];
  const sel = $("blueprint");
  sel.innerHTML = "";

  if (!list.length) {
    const opt = document.createElement("option");
    opt.value = "";
    opt.textContent = "No blueprints found";
    sel.appendChild(opt);
    return;
  }

  list.forEach(b => {
    const opt = document.createElement("option");
    opt.value = b;
    opt.textContent = "ğŸ“ " + b;
    sel.appendChild(opt);
  });
}

function parseFiles(lines) {
  return (lines || []).map(f => `ğŸ“„ ${f.filename} (${f.size} bytes)`).join("\n");
}

$("generate").onclick = async () => {
  const blueprint = $("blueprint").value;
  const spec = $("spec").value.trim();
  const wallet = $("wallet").value.trim() || localStorage.getItem('thr_address') || '';
  const model = $("model").value.trim();

  if (!blueprint) {
    alert("Please select a blueprint.");
    return;
  }
  if (!spec) {
    alert("Please enter specifications.");
    return;
  }

  const btn = $("generate");
  btn.disabled = true;
  btn.innerHTML = "â³ Generating...";

  $("out").textContent = "ğŸ”„ Generating architecture...\n\nPlease wait while Pythia analyzes your specifications...";
  $("files").style.display = "none";
  $("files").textContent = "";
  lastArchitectFiles = [];
  $("downloadZipBtn").disabled = true;

  try {
    const j = await api("/api/architect_generate", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ wallet, blueprint, spec, model })
    });

    setStatus(true);
    $("out").textContent = j.response || "No response received.";

    if (j.files && j.files.length) {
      $("files").style.display = "block";
      $("files").innerHTML = "<strong>ğŸ“ Generated Files:</strong><br>" + parseFiles(j.files);
    }
  } catch(e) {
    setStatus(false);
    $("out").textContent = "âŒ Error: " + e.message;
  } finally {
    btn.disabled = false;
    btn.innerHTML = 'ğŸš€ <span class="lang-el">Î”Î—ÎœÎ™ÎŸÎ¥Î¡Î“Î™Î‘ Î‘Î¡Î§Î™Î¤Î•ÎšÎ¤ÎŸÎÎ™ÎšÎ—Î£</span><span class="lang-en">GENERATE ARCHITECTURE</span><span class="lang-ja">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç”Ÿæˆ</span><span class="lang-ru">Ğ¡ĞĞ—Ğ”ĞĞ¢Ğ¬ ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ£</span><span class="lang-es">GENERAR ARQUITECTURA</span>';
    applyLanguage();
  }
};

// Load wallet from localStorage
const savedWallet = localStorage.getItem('thr_address');
if (savedWallet) {
  $("wallet").value = savedWallet;
}

// Initialize
(async () => {
  applyLanguage();
  try {
    await loadBlueprints();
    setStatus(true);
  } catch(e) {
    setStatus(false);
    console.error("Failed to load blueprints:", e);
  }
})();
</script>
</body>
</html>
