{% extends "base.html" %}

{% block title %}Thronos Network{% endblock %}

{% block styles %}
<style>
    .stats {
      background: #111;
      padding: 10px;
      margin-top: 20px;
      border: 1px dashed #0f0;
    }
    .game-link {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #f0f;
        color: #f0f;
        display: inline-block;
        text-decoration: none;
    }
    .game-link:hover {
        background: #200;
    }
    .beta-section {
        background: #1a001a;
        padding: 15px;
        margin-top: 20px;
        border: 1px dashed #f0f;
        color: #f0f;
    }
    .beta-btn {
        background: #300030;
        color: #f0f;
        border: 1px solid #f0f;
        padding: 8px 16px;
        text-decoration: none;
        display: inline-block;
        margin-top: 10px;
        cursor: pointer;
    }
    .beta-btn:hover {
        background: #500050;
    }
</style>
{% endblock %}

{% block content %}
<h1>ğŸ”¥ <span class="lang-el">ÎšÎ±Î»ÏÏ‚ Î®ÏÎ¸Î±Ï„Îµ ÏƒÏ„Î¿ Î”Î¯ÎºÏ„Ï…Î¿ Thronos</span><span class="lang-en">Welcome to the Thronos Network</span></h1>
<p>
    <span class="lang-el">ÎˆÎ½Î± blockchain Î±Î½Ï„Î¯ÏƒÏ„Î±ÏƒÎ·Ï‚. ÎœÎ¹Î± Î´Î­ÏƒÎ¼ÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Î¬ÎºÎ±Ï…ÏƒÏ„Î¿.</span>
    <span class="lang-en">A blockchain of resistance. A pledge to the unburnable.</span>
</p>

<div class="stats">
  <h2>ğŸ“ˆ <span class="lang-el">Î–Ï‰Î½Ï„Î±Î½Î¬ Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬ Î”Î¹ÎºÏ„ÏÎ¿Ï…</span><span class="lang-en">Live Network Stats</span></h2>
  <pre id="chainInfo"><span class="lang-el">Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î±Î»Ï…ÏƒÎ¯Î´Î±Ï‚...</span><span class="lang-en">Loading chain data...</span></pre>
</div>

<div class="stats">
  <h3>ğŸ’° <span class="lang-el">Î™ÏƒÎ¿Ï„Î¹Î¼Î¯Î±</span><span class="lang-en">Exchange Rate</span></h3>
  <p>1 THR = <span class="highlight">0.0001 BTC</span> (Pegged)</p>
</div>

<!-- Crypto Hunters Beta Section -->
<div class="beta-section">
    <h3>ğŸ® <span class="lang-el">Crypto Hunters - Beta & Î¨Î·Ï†Î¿Ï†Î¿ÏÎ¯Î±</span><span class="lang-en">Crypto Hunters - Beta & Voting</span></h3>
    <p>
        <span class="lang-el">Î›Î¬Î²ÎµÏ„Îµ Î¼Î­ÏÎ¿Ï‚ ÏƒÏ„Î¿ ÎºÏ…Î½Î®Î³Î¹! Î’Î¿Î·Î¸Î®ÏƒÏ„Îµ Î¼Î±Ï‚ Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ ÎµÏ€ÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï€Î±Î¹Ï‡Î½Î¯Î´Î¹ Crypto Hunters. Î¨Î·Ï†Î¯ÏƒÏ„Îµ Î³Î¹Î± Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ ÎºÎ±Î¹ ÎºÎµÏÎ´Î¯ÏƒÏ„Îµ Î±Î½Ï„Î±Î¼Î¿Î¹Î²Î­Ï‚.</span>
        <span class="lang-en">Join the hunt! Help us test the upcoming Crypto Hunters game. Vote on features and earn rewards.</span>
    </p>
    <a href="#" class="beta-btn" onclick="alert('Coming Soon! / Î£ÏÎ½Ï„Î¿Î¼Î± ÎºÎ¿Î½Ï„Î¬ ÏƒÎ±Ï‚!')">
        <span class="lang-el">ğŸ—³ï¸ Î¨Î·Ï†Î¯ÏƒÏ„Îµ Î¤ÏÏÎ± (Î£ÏÎ½Ï„Î¿Î¼Î±)</span><span class="lang-en">ğŸ—³ï¸ Vote Now (Coming Soon)</span>
    </a>
</div>

<a href="http://localhost:3000/panel" target="_blank" class="game-link">
    ğŸ‘¾ <span class="lang-el">Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Crypto Hunters (Dev)</span><span class="lang-en">Crypto Hunters Admin (Dev)</span>
</a>
{% endblock %}

{% block scripts %}
<script>
(function () {
  const labels = {
    el: {
      totalBlocks: "Î£ÏÎ½Î¿Î»Î¿ Blocks",
      lastHash:    "Hash Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï… Block",
      lastMiner:   "Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï‚ Miner",
      timestamp:   "Î§ÏÎ¿Î½Î¹ÎºÎ® Î£Î®Î¼Î±Î½ÏƒÎ·",
      totalSupply: "Î£Ï…Î½Î¿Î»Î¹ÎºÎ® Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹Î± THR"
    },
    en: {
      totalBlocks: "Total Blocks",
      lastHash:    "Last Block Hash",
      lastMiner:   "Last Miner",
      timestamp:   "Timestamp",
      totalSupply: "Total THR Supply"
    }
  };

  function renderStats(lastBlock, netStats) {
    const lang = localStorage.getItem("lang") || "el";
    const l = labels[lang];

    const blockCount  = (lastBlock && lastBlock.block_count) || (netStats && netStats.block_count) || 0;
    const totalSupply = (lastBlock && lastBlock.total_supply) || (netStats && netStats.total_supply) || 0;
    const lastHash    = (lastBlock && lastBlock.block_hash) || "N/A";
    const lastMiner   = (lastBlock && lastBlock.thr_address) || "N/A";
    const ts          = (lastBlock && lastBlock.timestamp) || "N/A";

    const html = `
${l.totalBlocks}: <span class="highlight">${blockCount}</span>\n
${l.totalSupply}: <span class="highlight">${totalSupply.toFixed(6)}</span> / ~420,000 THR\n
${l.lastHash}: ${lastHash}\n
${l.lastMiner}: ${lastMiner}\n
${l.timestamp}: ${ts}
`;
    document.getElementById("chainInfo").innerHTML = html;
  }

  function loadStats() {
    Promise.all([
      fetch("/last_block").then(r => r.json()).catch(() => ({})),
      fetch("/api/network_stats").then(r => r.json()).catch(() => ({})),
    ])
      .then(([lastBlock, netStats]) => {
        renderStats(lastBlock, netStats);
        // ÎšÏÎ±Ï„Î¬Î¼Îµ Ï„Î± Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± ÏƒÏ„Î¿Î½ window Î³Î¹Î± debugging Î±Î½ Î¸ÎµÏ‚
        window.__THR_LAST_BLOCK  = lastBlock;
        window.__THR_NET_STATS   = netStats;
      })
      .catch(err => {
        console.error(err);
        document.getElementById("chainInfo").innerText =
          "Failed to load network stats.";
      });
  }

  // Î±ÏÏ‡Î¹ÎºÏŒ load
  loadStats();

  // Î¾Î±Î½Î±ÎºÏ„Î¯ÏƒÎ¹Î¼Î¿ ÏŒÏ„Î±Î½ Î±Î»Î»Î¬Î¶ÎµÎ¹ Î· Î³Î»ÏÏƒÏƒÎ±
  window.addEventListener("langChanged", () => {
    renderStats(window.__THR_LAST_BLOCK || {}, window.__THR_NET_STATS || {});
  });

  // Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬: Î¼Î¹ÎºÏÏŒ auto-refresh Î±Î½Î¬ 30s
  setInterval(loadStats, 30000);
})();
</script>

{% endblock %}
